<div class="header bordered">
    Add New filter 
</div>

<div class="vpadded10">
    <input id="filterName" type="text" placeholder="Name" value="<%= model.get('name') %>" style="margin-left: 5px;"/>
</div>

<div id="newFilterHeader" class="filter-list-header clearfix">
    <div class="pull-left">
        Type:
    </div>
    <div class="pull-left">
        Value:
    </div>
</div>

<div class="wide-100 clearfix">
    <div id="binLogicOperator" class="logic-bin-operator pull-left">
        <label class="logicalOperatorContainer checkbox toggle well between-operators">
            <input id="<logicalOperatorCheckbox" class="logicalOperator" type="checkbox" checked />
            <p>
            <span>AND</span>
            <span>OR</span>
            </p>

            <a id="logicalOperator" class="btn btn-info slide-button"></a>
        </label>
    </div>
    <div id="addLogicBin" class="pull-left add-logic-bin">
        <img id="<%= model.get('_id') %>-addLogicBin-1" src="../../img/plus.png" class="icon-small vpadded5 pointer" />
    </div>
</div>

<div id="newTopLevelBin" class="logic-bin">
    <ul class="sortable ui-sortable connectedWith">
        <li id="BIN-ID" class="ui-state-default remove-default">
            <div id="logicBin1" class="wide-100 clearfix">
                <div class="wide-100 clearfix">
                    <div id="binLogicOperator" class="logic-bin-operator pull-left inner-logic-operator">
                        <label class="logicalOperatorContainer checkbox toggle well between-operators">
                            <input id="<logicalOperatorCheckbox" class="logicalOperator" type="checkbox" checked />
                            <p>
                            <span>AND</span>
                            <span>OR</span>
                            </p>

                            <a id="logicalOperator" class="btn btn-info slide-button"></a>
                        </label>
                    </div>
                    <div id="addLogicBin" class="pull-left add-logic-bin">
                        <img id="<%= model.get('_id') %>-addLogicBin-1" src="../../img/plus.png" class="icon-small vpadded5 pointer" />
                    </div>
                </div>
                <div id="logicBinContainer1" class="inner-logic-bin-container">
                    <ul id="innerBin" class="sortable ui-sortable .connectedWith">

                    </ul>

                </div>
            </div>
        </li>
        <% _.each(model.get("bins"), function(bin) { %>
        <li id="BIN-ID" class="ui-state-default remove-default">
            <div id="logicBin1" class="wide-100 clearfix">
                <div class="wide-100 clearfix">
                    <div id="binLogicOperator" class="logic-bin-operator pull-left inner-logic-operator">
                        <label class="logicalOperatorContainer checkbox toggle well between-operators">
                            <input id="<logicalOperatorCheckbox" class="logicalOperator" type="checkbox" checked />
                            <p>
                            <span>AND</span>
                            <span>OR</span>
                            </p>

                            <a id="logicalOperator" class="btn btn-info slide-button"></a>
                        </label>
                    </div>
                    <div id="addLogicBin" class="pull-left add-logic-bin">
                        <img id="<%= model.get('_id') %>-addLogicBin-1" src="../../img/plus.png" class="icon-small vpadded5 pointer" />
                    </div>
                </div>
                <div id="logicBinContainer1" class="inner-logic-bin-container">

                </div>
            </div>
        </li>
        <% _.each(bin.operators, function(operator) { %>
            <li id="<%= operator.order %>" class="ui-state-default">
            <% if (operator.get && operator.get("isSubFilter")) { %>
                <div class="operator-container clearfix">
                    <div class="wide-50">
                        <div class="clearfix operator">
                            <div class="pull-left">
                                Subfilter 
                            </div>
                        </div>
                    </div>
                    <div class="wide-50">
                        <div class="clearfix subFilter-operator">
                            <div class="pull-right">
                                <div class="plus-minus-container sub-filter-marker subFilter subFilter-1 clearfix">
                                    <div class="pull-right">
                                        <img id="<%= operator.get('order') %>-subFilter-1" src="../../img/arrow-right.png" class="icon-small vpadded5" />
                                    </div>
                                    <div id="<%= operator.get('order') %>-subFilterContainer-1" class="pull-right padded5 viewSubFilter-1">
                                        View Sub-filter
                                    </div>
                                </div>
                            </div>
                            <div class="pull-right wide-20 centered">
                                <div class="plus-minus-container">
                                    <img id="<%=operator.order %>-1" src="../../img/minus.png" class="icon-small vertical-5 delete-row" />
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                    <% } 
                    else { %>
                <div class="operator-container clearfix">
                    <div class="wide-50 clearfix">
                        <div class="clearfix">
                            <div class="pull-left operator">
                                <select id="<%= operator.order + '-property' %>">
                                    <% _.each(features, function(feature) { %>
                                    <option value="<%= feature.name %>" <% if (operator.property == feature.name) { %> selected <% } %>><%= feature.name %></option>
                                    <% }); %>
                                </select>
                            </div>
                            <div class="centered inline operator-type-select">
                                    <select id="<%= operator.order + '-type' %>">
                                        <% _.each(types, function(type) { %>
                                        <option value="<%= type %>" <% if (operator.type == type) { %> selected <% } %>><%= type %></option>
                                        <% }); %>
                                    </select>
                            </div>
                        </div>
                    </div>
                    <div class="wide-50 clearfix">
                        <div class="clearfix">
                            <div class="pull-left wide-80">
                                <div class="inline <%= operator.upperBoundary ? 'wide-50' : 'wide-100' %>">
                                    <input id="<%= operator.order + '-lower' %>" type="text" class="wide-90 staged" value="<%= operator.value ? operator.value : operator.lowerBoundary %>" />
                                </div>
                                <div class="inline <%= operator.upperBoundary ? 'wide-50' : 'hide' %>">
                                    <input id="<%= operator.order + '-upper' %>" type="text" class="wide-90 staged <%= operator.upperBoundary ? '' : 'hide' %>" value="<%= operator.upperBoundary %>" />
                                </div>
                            </div>
                            <div class="pull-right plus-minus-container wide-20 centered">
                                <img id="<%=operator.order%>" src="../../img/minus.png" class="icon-small vpadded5 delete-row" />
                            </div>
                        </div>
                    </div>
                </div>
                <% } %>
            </li>
            <% }); %>
            <% }); %>

            <% _.each(model.get("topLevelBin").operators, function(operator) { %>
            <li id="<%= operator.order %>" class="ui-state-default">
            <% if (operator.get && operator.get("isSubFilter")) { %>
                <div class="operator-container clearfix">
                    <div class="wide-50">
                        <div class="clearfix operator">
                            <div class="pull-left">
                                Subfilter 
                            </div>
                        </div>
                    </div>
                    <div class="wide-50">
                        <div class="clearfix subFilter-operator">
                            <div class="pull-right">
                                <div class="plus-minus-container sub-filter-marker subFilter subFilter-1 clearfix">
                                    <div class="pull-right">
                                        <img id="<%= operator.get('order') %>-subFilter-1" src="../../img/arrow-right.png" class="icon-small vpadded5" />
                                    </div>
                                    <div id="<%= operator.get('order') %>-subFilterContainer-1" class="pull-right padded5 viewSubFilter-1">
                                        View Sub-filter
                                    </div>
                                </div>
                            </div>
                            <div class="pull-right wide-20 centered">
                                <div class="plus-minus-container">
                                    <img id="<%=operator.order %>-1" src="../../img/minus.png" class="icon-small vertical-5 delete-row" />
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                    <% } 
                    else { %>
                <div class="operator-container clearfix">
                    <div class="wide-50 clearfix">
                        <div class="clearfix">
                            <div class="pull-left operator">
                                <select id="<%= operator.order + '-property' %>">
                                    <% _.each(features, function(feature) { %>
                                    <option value="<%= feature.name %>" <% if (operator.property == feature.name) { %> selected <% } %>><%= feature.name %></option>
                                    <% }); %>
                                </select>
                            </div>
                            <div class="centered inline operator-type-select">
                                    <select id="<%= operator.order + '-type' %>">
                                        <% _.each(types, function(type) { %>
                                        <option value="<%= type %>" <% if (operator.type == type) { %> selected <% } %>><%= type %></option>
                                        <% }); %>
                                    </select>
                            </div>
                        </div>
                    </div>
                    <div class="wide-50 clearfix">
                        <div class="clearfix">
                            <div class="pull-left wide-80">
                                <div class="inline <%= operator.upperBoundary ? 'wide-50' : 'wide-100' %>">
                                    <input id="<%= operator.order + '-lower' %>" type="text" class="wide-90 staged" value="<%= operator.value ? operator.value : operator.lowerBoundary %>" />
                                </div>
                                <div class="inline <%= operator.upperBoundary ? 'wide-50' : 'hide' %>">
                                    <input id="<%= operator.order + '-upper' %>" type="text" class="wide-90 staged <%= operator.upperBoundary ? '' : 'hide' %>" value="<%= operator.upperBoundary %>" />
                                </div>
                            </div>
                            <div class="pull-right plus-minus-container wide-20 centered">
                                <img id="<%=operator.order%>" src="../../img/minus.png" class="icon-small vpadded5 delete-row" />
                            </div>
                        </div>
                    </div>
                </div>
                <% } %>
                </li>
                <% }); %>
    </ul>
</div>

<div id="newOperatorsContainer">
    <div class="operator-container clearfix">
        <div class="wide-50 clearfix">
            <div class="clearfix">
                <div class="pull-left operator">
                    <select id="newProperty">
                        <% _.each(features, function(feature) { %>
                            <option value="<%= feature.name %>"><%= feature.name %></option>
                        <% }); %>
                    </select>
                </div>
                <div class="centered inline operator-type-select">
                    <select id="newType">
                        <% _.each(types, function(type) { %>
                            <option value="<%= type %>"><%= type %></option>
                        <% }); %>
                    </select>
                </div>
            </div>
        </div>
        <div class="wide-50 clearfix">
            <div class="clearfix">
                <div class="pull-left wide-80">
                    <div class="inline wide-100">
                        <input id="newLower" type="text" class="wide-90 staged" >
                    </div>
                    <div class="inline wide-50">
                        <input id="newUpper" type="text" class="wide-90 staged hide">
                    </div>
                </div>
                <div class="pull-right">
                    <div class="plus-minus-container sub-filter-marker new subFilter subFilter-1 clearfix">
                        <div class="pull-right">
                            <img id="newSubFilter" src="../../img/arrow-right.png" class="icon-small vpadded5" />
                        </div>
                        <div id="newSubFilterContainer" class="pull-right margin-centered padded5">
                            New Sub-filter
                        </div>
                    </div>
                </div>
                <div class="pull-right plus-minus-container wide-20 centered">
                    <img src="../../img/plus.png" class="icon-small vpadded5 add-row" />
                </div>
            </div>
        </div>
    </div>
</div>

<div class="pull-right padded">
    <button id="clearFilter" class="btn"> Clear </button>
    <button id="createFilter" class="btn"> Create </button>
    <button id="applyFilter" class="btn"> Apply </button>
</div>

